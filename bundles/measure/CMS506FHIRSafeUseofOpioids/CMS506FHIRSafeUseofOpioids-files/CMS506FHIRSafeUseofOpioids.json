{
  "resourceType": "Library",
  "id": "CMS506FHIRSafeUseofOpioids",
  "meta": {
    "profile": [ "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-shareablelibrary", "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-computablelibrary", "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-publishablelibrary", "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-executablelibrary", "http://hl7.org/fhir/uv/cql/StructureDefinition/cql-library", "http://hl7.org/fhir/uv/cql/StructureDefinition/elm-json-library", "http://hl7.org/fhir/uv/cql/StructureDefinition/elm-xml-library" ]
  },
  "language": "en",
  "text": {
    "status": "extensions",
    "div": "<div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"col-12\">\n  <table class=\"narrative-table\">\n    <tbody>\n<tr>\n\n<th colspan=\"2\" scope=\"row\" class=\"row-header\">Knowledge Artifact Metadata</th>\n\n</tr>\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Name (machine-readable)</th>\n\n<td class=\"content-container\">CMS506FHIRSafeUseofOpioids</td>\n</tr>\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Title (human-readable)</th>\n\n<td class=\"content-container\">CMS506FHIRSafeUseofOpioids</td>\n</tr>\n\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Status</th>\n\n<td class=\"content-container\">active</td>\n</tr>\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Experimental</th>\n\n<td class=\"content-container\">false</td>\n</tr>\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Description</th>\n\n<td class=\"content-container\">CMS506FHIRSafeUseofOpioids</td>\n</tr>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Library Steward</th>\n\n<td class=\"content-container\">Centers for Medicare &amp; Medicaid Services (CMS)</td>\n</tr>\n\n\n\n\n\n\n\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Library SDE\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: https://madie.cms.gov/Library/SupplementalDataElements|5.1.000\n    <br/>\n    <em>Canonical URL</em>: <tt>https://madie.cms.gov/Library/SupplementalDataElements|5.1.000</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Library CQMCommon\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: https://madie.cms.gov/Library/CQMCommon|4.1.000\n    <br/>\n    <em>Canonical URL</em>: <tt>https://madie.cms.gov/Library/CQMCommon|4.1.000</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Library FHIRHelpers\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: https://madie.cms.gov/Library/FHIRHelpers|4.4.000\n    <br/>\n    <em>Canonical URL</em>: <tt>https://madie.cms.gov/Library/FHIRHelpers|4.4.000</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Library QICoreCommon\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: https://madie.cms.gov/Library/QICoreCommon|4.0.000\n    <br/>\n    <em>Canonical URL</em>: <tt>https://madie.cms.gov/Library/QICoreCommon|4.0.000</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Schedule II, III and IV Opioid Medications\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1046.241\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1046.241</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Schedule IV Benzodiazepines\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1125.1\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1125.1</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Cancer Related Pain\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.180\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.180</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Sickle Cell Disease with and without Crisis\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.175\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.175</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Medications for Opioid Use Disorder (MOUD)\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1046.269\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1046.269</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Opioid Medication Assisted Treatment (MAT)\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.177\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.177</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Opioid Use Disorder\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.171\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.171</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Palliative or Hospice Care\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.600.1.1579\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.600.1.1579</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Discharge To Acute Care Facility\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.87\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.87</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Hospice Care Referral or Admission\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1116.365\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1116.365</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Patient Expired\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.309\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.309</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Left Against Medical Advice\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.308\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.308</tt>\n    \n  </td>\n</tr>\n\n\n\n\n\n\n\n\n\n\n<tr>\n\n<th colspan=\"2\" scope=\"row\" class=\"row-header\">Library Metadata</th>\n\n</tr>\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Identifier</th>\n\n<td class=\"content-container\">org.hl7.fhir.r5.model.Identifier@4f42a513</td>\n</tr>\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Version Number</th>\n\n<td class=\"content-container\">0.3.007</td>\n</tr>\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Library Type</th>\n\n<td class=\"content-container\">[http://terminology.hl7.org/CodeSystem/library-type#logic-library]</td>\n</tr>\n\n\n\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: MedicationRequest\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: medication, status, status.value, intent, intent.value, authoredOn, authoredOn.value\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: medication</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1046.241\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: MedicationRequest\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: medication, status, status.value, intent, intent.value, authoredOn, authoredOn.value\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: medication</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1125.1\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: MedicationRequest\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: medication, status, status.value, intent, intent.value, authoredOn, authoredOn.value\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: medication</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1046.269\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: MedicationRequest\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: medication.reference.value, status, status.value, intent, intent.value, authoredOn, authoredOn.value, medication\n    <br/>\n   \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Medication\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medication\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: id.value, code\n    <br/>\n   \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Condition\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-problems-health-concerns\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code, verificationStatus\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.180\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Condition\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-problems-health-concerns\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code, verificationStatus\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.175\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Condition\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-problems-health-concerns\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code, verificationStatus\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.171\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Procedure\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-procedure\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code, performed, status, status.value\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.177\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Procedure\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-procedure\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code, status, status.value\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.600.1.1579\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: ServiceRequest\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-servicerequest\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code, status, status.value\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.600.1.1579\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n\n\n  <tr>\n\n<th colspan=\"2\" scope=\"row\" class=\"row-header\">Library Content</th>\n\n</tr>\n  \n    \n    <tr>\n      <th scope=\"row\" class=\"row-header\">CQL Content</th>\n      <td>\n        <pre style=\"border: none;\" class=\"content-container highlight language-cql\"><code class=\"language-cql\">library CMS506FHIRSafeUseofOpioids version '0.3.007'\r\n\r\nusing QICore version '6.0.0'\r\n\r\ninclude CQMCommon version '4.1.000' called CQMCommon\r\ninclude FHIRHelpers version '4.4.000' called FHIRHelpers\r\ninclude QICoreCommon version '4.0.000' called QICoreCommon\r\ninclude SupplementalDataElements version '5.1.000' called SDE\r\n\r\nvalueset &quot;Cancer Related Pain&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.180'\r\nvalueset &quot;Discharge To Acute Care Facility&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.87'\r\nvalueset &quot;Hospice Care Referral or Admission&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1116.365'\r\nvalueset &quot;Left Against Medical Advice&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.308'\r\nvalueset &quot;Medications for Opioid Use Disorder (MOUD)&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1046.269'\r\nvalueset &quot;Opioid Medication Assisted Treatment (MAT)&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.177'\r\nvalueset &quot;Opioid Use Disorder&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.171'\r\nvalueset &quot;Palliative or Hospice Care&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.600.1.1579'\r\nvalueset &quot;Patient Expired&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.309'\r\nvalueset &quot;Schedule II, III and IV Opioid Medications&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1046.241'\r\nvalueset &quot;Schedule IV Benzodiazepines&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1125.1'\r\nvalueset &quot;Sickle Cell Disease with and without Crisis&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.175'\r\n\r\nparameter &quot;Measurement Period&quot; Interval&lt;DateTime&gt;\r\n\r\ncontext Patient\r\n\r\ndefine &quot;Initial Population&quot;:\r\n  &quot;Inpatient Encounters With An Opioid Or Benzodiazepine At Discharge&quot;\r\n\r\ndefine &quot;Denominator&quot;:\r\n  &quot;Initial Population&quot;\r\n\r\ndefine &quot;Inpatient Encounter With Age Greater Than Or Equal To 18&quot;:\r\n  CQMCommon.&quot;Inpatient Encounter&quot; InpatientHospitalEncounter\r\n    where AgeInYearsAt(date from start of InpatientHospitalEncounter.period) &gt;= 18\r\n\r\ndefine &quot;Inpatient Encounters With An Opioid Or Benzodiazepine At Discharge&quot;:\n/*Captures encounters of patients with an opioid and/or benzodiazepine at discharge*/\r\n  \r\n  &quot;Inpatient Encounter With Age Greater Than Or Equal To 18&quot; InpatientEncounter\r\n    with ( &quot;Opioid At Discharge&quot;\r\n      union &quot;Benzodiazepine At Discharge&quot; ) OpioidOrBenzodiazepineAtDischarge\r\n      such that OpioidOrBenzodiazepineAtDischarge.authoredOn during day of InpatientEncounter.period\r\n\r\ndefine &quot;Benzodiazepine At Discharge&quot;:\r\n  [&quot;MedicationRequest&quot;: &quot;Schedule IV Benzodiazepines&quot;] BenzoMedications\r\n    where ( BenzoMedications.isCommunity ( )\r\n        or BenzoMedications.isDischarge ( )\r\n    )\r\n      and BenzoMedications.status in { 'active', 'completed' }\r\n      and BenzoMedications.intent in { 'order', 'original-order', 'reflex-order', 'filler-order', 'instance-order' }\r\n\r\ndefine &quot;Opioid At Discharge&quot;:\r\n  [&quot;MedicationRequest&quot;: &quot;Schedule II, III and IV Opioid Medications&quot;] OpioidMedications\r\n    where ( OpioidMedications.isCommunity ( )\r\n        or OpioidMedications.isDischarge ( )\r\n    )\r\n      and OpioidMedications.status in { 'active', 'completed' }\r\n      and OpioidMedications.intent in { 'order', 'original-order', 'reflex-order', 'filler-order', 'instance-order' }\r\n\r\ndefine &quot;Numerator&quot;:\n  /*Encounters of patients prescribed two or more opioids or an opioid and benzodiazepine at discharge.*/\r\n  \r\n  &quot;Denominator&quot; InpatientEncounter\r\n    where ( Count(&quot;Opioid At Discharge&quot; OpioidMedications\r\n          where OpioidMedications.authoredOn during day of InpatientEncounter.period\r\n          return distinct OpioidMedications.medication\r\n      ) &gt;= 2\r\n    )\r\n      or ( exists &quot;Opioid At Discharge&quot; OpioidDischargeMedications\r\n          where OpioidDischargeMedications.authoredOn during day of InpatientEncounter.period\r\n            and exists ( &quot;Benzodiazepine At Discharge&quot; BenzodiazepineDischargeMedication\r\n                where BenzodiazepineDischargeMedication.authoredOn during day of InpatientEncounter.period\r\n            )\r\n      )\r\n\r\ndefine &quot;Inpatient Encounter With Encounter Diagnosis Of Cancer Pain&quot;:\r\n  &quot;Denominator&quot; QualifyingEncounter\r\n    where QualifyingEncounter.reasonCode in &quot;Cancer Related Pain&quot;\r\n      or QualifyingEncounter.encounterDiagnosis ( ).code in &quot;Cancer Related Pain&quot;\r\n\r\ndefine &quot;Denominator Exclusion&quot;:\n  /*Excludes encounters of patients with cancer pain or who are receiving palliative or hospice care at the time of the encounter or who receive treatment for opioid use disorder, have sickle cell disease, or who are discharged to another inpatient care facility or discharged against medical advice, or expire during the inpatient stay*/\r\n  \r\n  &quot;Denominator&quot; InpatientEncounter\r\n    where exists ( [&quot;ConditionProblemsHealthConcerns&quot;: &quot;Cancer Related Pain&quot;] CancerPain\r\n        where CancerPain.prevalenceInterval ( ) overlaps day of InpatientEncounter.period\r\n          and ( CancerPain.verificationStatus is not null implies ( CancerPain.verificationStatus !~ QICoreCommon.&quot;refuted&quot;\r\n                or CancerPain.verificationStatus !~ QICoreCommon.&quot;entered-in-error&quot;\r\n            )\r\n          )\r\n    )\r\n      or exists ( &quot;Inpatient Encounter With Encounter Diagnosis Of Cancer Pain&quot; )\r\n      or exists ( [&quot;ConditionProblemsHealthConcerns&quot;: &quot;Sickle Cell Disease with and without Crisis&quot;] SickleCellDisease\r\n          where SickleCellDisease.prevalenceInterval ( ) overlaps day of InpatientEncounter.period\r\n            and ( SickleCellDisease.verificationStatus is not null implies ( SickleCellDisease.verificationStatus !~ QICoreCommon.&quot;refuted&quot;\r\n                  or SickleCellDisease.verificationStatus !~ QICoreCommon.&quot;entered-in-error&quot;\r\n              )\r\n            )\r\n      )\r\n      or exists ( &quot;Treatment For Opioid Use Disorders&quot; OUDTreatment\r\n          where OUDTreatment.authoredOn during day of InpatientEncounter.period\r\n      )\r\n      or exists ( &quot;Intervention Palliative Or Hospice Care&quot; PalliativeOrHospiceCare\r\n          where Coalesce(start of PalliativeOrHospiceCare.performed.toInterval(), PalliativeOrHospiceCare.authoredOn) during InpatientEncounter.hospitalizationWithObservation ( )\r\n      )\r\n      or ( InpatientEncounter.hospitalization.dischargeDisposition in &quot;Discharge To Acute Care Facility&quot;\r\n          or InpatientEncounter.hospitalization.dischargeDisposition in &quot;Hospice Care Referral or Admission&quot;\r\n          or InpatientEncounter.hospitalization.dischargeDisposition in &quot;Patient Expired&quot;\r\n          or InpatientEncounter.hospitalization.dischargeDisposition in &quot;Left Against Medical Advice&quot;\r\n      )\r\n\r\ndefine &quot;Treatment For Opioid Use Disorders&quot;:\r\n  ( &quot;Medications For Opioid Use Disorder&quot; MedicationTreatment\r\n      with [&quot;Procedure&quot;: &quot;Opioid Medication Assisted Treatment (MAT)&quot;] MAT\r\n        such that MedicationTreatment.authoredOn during day of MAT.performed.toInterval ( )\r\n          and MedicationTreatment.authoredOn during day of &quot;Measurement Period&quot;\r\n          and MAT.status in { 'completed', 'in-progress' }\r\n  )\r\n    union ( &quot;Medications For Opioid Use Disorder&quot; MedicationTreatment\r\n        with [&quot;ConditionProblemsHealthConcerns&quot;: &quot;Opioid Use Disorder&quot;] OUD\r\n          such that MedicationTreatment.authoredOn during day of OUD.prevalenceInterval ( )\r\n            and OUD.prevalenceInterval ( ) overlaps day of &quot;Measurement Period&quot;\r\n            and ( OUD.verificationStatus is not null implies ( OUD.verificationStatus !~ QICoreCommon.&quot;refuted&quot;\r\n                  or OUD.verificationStatus !~ QICoreCommon.&quot;entered-in-error&quot;\r\n              )\r\n            )\r\n    )\r\n\r\ndefine &quot;Medications For Opioid Use Disorder&quot;:\r\n  [&quot;MedicationRequest&quot;: &quot;Medications for Opioid Use Disorder (MOUD)&quot;] DischargeMedication\r\n    where ( DischargeMedication.isCommunity ( )\r\n        or DischargeMedication.isDischarge ( )\r\n    )\r\n      and DischargeMedication.status in { 'active', 'completed' }\r\n      and DischargeMedication.intent in { 'order', 'original-order', 'reflex-order', 'filler-order', 'instance-order' }\r\n\r\ndefine &quot;Intervention Palliative Or Hospice Care&quot;:\r\n  ( [&quot;ServiceRequest&quot;: &quot;Palliative or Hospice Care&quot;] PalliativeOrHospiceCareOrder\r\n      where PalliativeOrHospiceCareOrder.status in { 'active', 'completed', 'on-hold' }\r\n  )\r\n    union ( [&quot;Procedure&quot;: &quot;Palliative or Hospice Care&quot;] PalliativeOrHospiceCarePerformed\r\n        where PalliativeOrHospiceCarePerformed.status in { 'completed', 'in-progress' }\r\n    )\r\n\r\ndefine &quot;SDE Ethnicity&quot;:\r\n  SDE.&quot;SDE Ethnicity&quot;\r\n\r\ndefine &quot;SDE Payer&quot;:\r\n  SDE.&quot;SDE Payer&quot;\r\n\r\ndefine &quot;SDE Race&quot;:\r\n  SDE.&quot;SDE Race&quot;\r\n\r\ndefine &quot;SDE Sex&quot;:\r\n  SDE.&quot;SDE Sex&quot;</code></pre>\n      </td>\n    </tr>\n    \n    \n    \n  \n\n<tr>\n  <th colspan=\"2\" scope=\"row\" class=\"row-header\">Generated using version 0.4.7 of the sample-content-ig Liquid templates</th>\n</tr>\n\n    </tbody>\n  </table>\n</div>"
  },
  "contained": [ {
    "resourceType": "Parameters",
    "id": "options",
    "parameter": [ {
      "name": "translatorVersion",
      "valueString": "3.25.0"
    }, {
      "name": "option",
      "valueString": "EnableAnnotations"
    }, {
      "name": "option",
      "valueString": "EnableLocators"
    }, {
      "name": "option",
      "valueString": "DisableListDemotion"
    }, {
      "name": "option",
      "valueString": "DisableListPromotion"
    }, {
      "name": "format",
      "valueString": "XML"
    }, {
      "name": "format",
      "valueString": "JSON"
    }, {
      "name": "analyzeDataRequirements",
      "valueBoolean": false
    }, {
      "name": "collapseDataRequirements",
      "valueBoolean": false
    }, {
      "name": "compatibilityLevel",
      "valueString": "1.5"
    }, {
      "name": "enableCqlOnly",
      "valueBoolean": false
    }, {
      "name": "errorLevel",
      "valueString": "Info"
    }, {
      "name": "signatureLevel",
      "valueString": "Overloads"
    }, {
      "name": "validateUnits",
      "valueBoolean": true
    }, {
      "name": "verifyOnly",
      "valueBoolean": false
    } ]
  } ],
  "extension": [ {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-cqlOptions",
    "valueReference": {
      "reference": "#options"
    }
  }, {
    "url": "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-softwaresystem",
    "valueReference": {
      "reference": "Device/cqf-tooling"
    }
  } ],
  "url": "https://madie.cms.gov/Library/CMS506FHIRSafeUseofOpioids",
  "identifier": [ {
    "use": "official",
    "system": "https://madie.cms.gov/login",
    "value": "CMS506FHIRSafeUseofOpioids"
  } ],
  "version": "0.3.007",
  "name": "CMS506FHIRSafeUseofOpioids",
  "title": "CMS506FHIRSafeUseofOpioids",
  "status": "active",
  "experimental": false,
  "type": {
    "coding": [ {
      "system": "http://terminology.hl7.org/CodeSystem/library-type",
      "code": "logic-library"
    } ]
  },
  "date": "2025-07-07T16:25:34+00:00",
  "publisher": "Centers for Medicare & Medicaid Services (CMS)",
  "description": "CMS506FHIRSafeUseofOpioids",
  "content": [ {
    "contentType": "text/cql",
    "data": "bGlicmFyeSBDTVM1MDZGSElSU2FmZVVzZW9mT3Bpb2lkcyB2ZXJzaW9uICcwLjMuMDA3Jw0KDQp1c2luZyBRSUNvcmUgdmVyc2lvbiAnNi4wLjAnDQoNCmluY2x1ZGUgQ1FNQ29tbW9uIHZlcnNpb24gJzQuMS4wMDAnIGNhbGxlZCBDUU1Db21tb24NCmluY2x1ZGUgRkhJUkhlbHBlcnMgdmVyc2lvbiAnNC40LjAwMCcgY2FsbGVkIEZISVJIZWxwZXJzDQppbmNsdWRlIFFJQ29yZUNvbW1vbiB2ZXJzaW9uICc0LjAuMDAwJyBjYWxsZWQgUUlDb3JlQ29tbW9uDQppbmNsdWRlIFN1cHBsZW1lbnRhbERhdGFFbGVtZW50cyB2ZXJzaW9uICc1LjEuMDAwJyBjYWxsZWQgU0RFDQoNCnZhbHVlc2V0ICJDYW5jZXIgUmVsYXRlZCBQYWluIjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzc2Mi4xLjQuMTExMS4xODAnDQp2YWx1ZXNldCAiRGlzY2hhcmdlIFRvIEFjdXRlIENhcmUgRmFjaWxpdHkiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzODgzLjMuMTE3LjEuNy4xLjg3Jw0KdmFsdWVzZXQgIkhvc3BpY2UgQ2FyZSBSZWZlcnJhbCBvciBBZG1pc3Npb24iOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMTE2LjM2NScNCnZhbHVlc2V0ICJMZWZ0IEFnYWluc3QgTWVkaWNhbCBBZHZpY2UiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzODgzLjMuMTE3LjEuNy4xLjMwOCcNCnZhbHVlc2V0ICJNZWRpY2F0aW9ucyBmb3IgT3Bpb2lkIFVzZSBEaXNvcmRlciAoTU9VRCkiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMDQ2LjI2OScNCnZhbHVlc2V0ICJPcGlvaWQgTWVkaWNhdGlvbiBBc3Npc3RlZCBUcmVhdG1lbnQgKE1BVCkiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMTExLjE3NycNCnZhbHVlc2V0ICJPcGlvaWQgVXNlIERpc29yZGVyIjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzc2Mi4xLjQuMTExMS4xNzEnDQp2YWx1ZXNldCAiUGFsbGlhdGl2ZSBvciBIb3NwaWNlIENhcmUiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzODgzLjMuNjAwLjEuMTU3OScNCnZhbHVlc2V0ICJQYXRpZW50IEV4cGlyZWQiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzODgzLjMuMTE3LjEuNy4xLjMwOScNCnZhbHVlc2V0ICJTY2hlZHVsZSBJSSwgSUlJIGFuZCBJViBPcGlvaWQgTWVkaWNhdGlvbnMiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMDQ2LjI0MScNCnZhbHVlc2V0ICJTY2hlZHVsZSBJViBCZW56b2RpYXplcGluZXMiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMTI1LjEnDQp2YWx1ZXNldCAiU2lja2xlIENlbGwgRGlzZWFzZSB3aXRoIGFuZCB3aXRob3V0IENyaXNpcyI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM3NjIuMS40LjExMTEuMTc1Jw0KDQpwYXJhbWV0ZXIgIk1lYXN1cmVtZW50IFBlcmlvZCIgSW50ZXJ2YWw8RGF0ZVRpbWU+DQogIGRlZmF1bHQgSW50ZXJ2YWxbQDIwMjYtMDEtMDFUMDA6MDA6MDAuMFosIEAyMDI2LTEyLTMxVDIzOjU5OjAwLjBaICkNCg0KY29udGV4dCBQYXRpZW50DQoNCmRlZmluZSAiSW5pdGlhbCBQb3B1bGF0aW9uIjoNCiAgIklucGF0aWVudCBFbmNvdW50ZXJzIFdpdGggQW4gT3Bpb2lkIE9yIEJlbnpvZGlhemVwaW5lIEF0IERpc2NoYXJnZSINCg0KZGVmaW5lICJEZW5vbWluYXRvciI6DQogICJJbml0aWFsIFBvcHVsYXRpb24iDQoNCmRlZmluZSAiSW5wYXRpZW50IEVuY291bnRlciBXaXRoIEFnZSBHcmVhdGVyIFRoYW4gT3IgRXF1YWwgVG8gMTgiOg0KICBDUU1Db21tb24uIklucGF0aWVudCBFbmNvdW50ZXIiIElucGF0aWVudEhvc3BpdGFsRW5jb3VudGVyDQogICAgd2hlcmUgQWdlSW5ZZWFyc0F0KGRhdGUgZnJvbSBzdGFydCBvZiBJbnBhdGllbnRIb3NwaXRhbEVuY291bnRlci5wZXJpb2QpID49IDE4DQoNCmRlZmluZSAiSW5wYXRpZW50IEVuY291bnRlcnMgV2l0aCBBbiBPcGlvaWQgT3IgQmVuem9kaWF6ZXBpbmUgQXQgRGlzY2hhcmdlIjoNCi8qQ2FwdHVyZXMgZW5jb3VudGVycyBvZiBwYXRpZW50cyB3aXRoIGFuIG9waW9pZCBhbmQvb3IgYmVuem9kaWF6ZXBpbmUgYXQgZGlzY2hhcmdlKi8NCiAgDQogICJJbnBhdGllbnQgRW5jb3VudGVyIFdpdGggQWdlIEdyZWF0ZXIgVGhhbiBPciBFcXVhbCBUbyAxOCIgSW5wYXRpZW50RW5jb3VudGVyDQogICAgd2l0aCAoICJPcGlvaWQgQXQgRGlzY2hhcmdlIg0KICAgICAgdW5pb24gIkJlbnpvZGlhemVwaW5lIEF0IERpc2NoYXJnZSIgKSBPcGlvaWRPckJlbnpvZGlhemVwaW5lQXREaXNjaGFyZ2UNCiAgICAgIHN1Y2ggdGhhdCBPcGlvaWRPckJlbnpvZGlhemVwaW5lQXREaXNjaGFyZ2UuYXV0aG9yZWRPbiBkdXJpbmcgZGF5IG9mIElucGF0aWVudEVuY291bnRlci5wZXJpb2QNCg0KZGVmaW5lICJCZW56b2RpYXplcGluZSBBdCBEaXNjaGFyZ2UiOg0KICBbIk1lZGljYXRpb25SZXF1ZXN0IjogIlNjaGVkdWxlIElWIEJlbnpvZGlhemVwaW5lcyJdIEJlbnpvTWVkaWNhdGlvbnMNCiAgICB3aGVyZSAoIEJlbnpvTWVkaWNhdGlvbnMuaXNDb21tdW5pdHkgKCApDQogICAgICAgIG9yIEJlbnpvTWVkaWNhdGlvbnMuaXNEaXNjaGFyZ2UgKCApDQogICAgKQ0KICAgICAgYW5kIEJlbnpvTWVkaWNhdGlvbnMuc3RhdHVzIGluIHsgJ2FjdGl2ZScsICdjb21wbGV0ZWQnIH0NCiAgICAgIGFuZCBCZW56b01lZGljYXRpb25zLmludGVudCBpbiB7ICdvcmRlcicsICdvcmlnaW5hbC1vcmRlcicsICdyZWZsZXgtb3JkZXInLCAnZmlsbGVyLW9yZGVyJywgJ2luc3RhbmNlLW9yZGVyJyB9DQoNCmRlZmluZSAiT3Bpb2lkIEF0IERpc2NoYXJnZSI6DQogIFsiTWVkaWNhdGlvblJlcXVlc3QiOiAiU2NoZWR1bGUgSUksIElJSSBhbmQgSVYgT3Bpb2lkIE1lZGljYXRpb25zIl0gT3Bpb2lkTWVkaWNhdGlvbnMNCiAgICB3aGVyZSAoIE9waW9pZE1lZGljYXRpb25zLmlzQ29tbXVuaXR5ICggKQ0KICAgICAgICBvciBPcGlvaWRNZWRpY2F0aW9ucy5pc0Rpc2NoYXJnZSAoICkNCiAgICApDQogICAgICBhbmQgT3Bpb2lkTWVkaWNhdGlvbnMuc3RhdHVzIGluIHsgJ2FjdGl2ZScsICdjb21wbGV0ZWQnIH0NCiAgICAgIGFuZCBPcGlvaWRNZWRpY2F0aW9ucy5pbnRlbnQgaW4geyAnb3JkZXInLCAnb3JpZ2luYWwtb3JkZXInLCAncmVmbGV4LW9yZGVyJywgJ2ZpbGxlci1vcmRlcicsICdpbnN0YW5jZS1vcmRlcicgfQ0KDQpkZWZpbmUgIk51bWVyYXRvciI6DQogIC8qRW5jb3VudGVycyBvZiBwYXRpZW50cyBwcmVzY3JpYmVkIHR3byBvciBtb3JlIG9waW9pZHMgb3IgYW4gb3Bpb2lkIGFuZCBiZW56b2RpYXplcGluZSBhdCBkaXNjaGFyZ2UuKi8NCiAgDQogICJEZW5vbWluYXRvciIgSW5wYXRpZW50RW5jb3VudGVyDQogICAgd2hlcmUgKCBDb3VudCgiT3Bpb2lkIEF0IERpc2NoYXJnZSIgT3Bpb2lkTWVkaWNhdGlvbnMNCiAgICAgICAgICB3aGVyZSBPcGlvaWRNZWRpY2F0aW9ucy5hdXRob3JlZE9uIGR1cmluZyBkYXkgb2YgSW5wYXRpZW50RW5jb3VudGVyLnBlcmlvZA0KICAgICAgICAgIHJldHVybiBkaXN0aW5jdCBPcGlvaWRNZWRpY2F0aW9ucy5tZWRpY2F0aW9uDQogICAgICApID49IDINCiAgICApDQogICAgICBvciAoIGV4aXN0cyAiT3Bpb2lkIEF0IERpc2NoYXJnZSIgT3Bpb2lkRGlzY2hhcmdlTWVkaWNhdGlvbnMNCiAgICAgICAgICB3aGVyZSBPcGlvaWREaXNjaGFyZ2VNZWRpY2F0aW9ucy5hdXRob3JlZE9uIGR1cmluZyBkYXkgb2YgSW5wYXRpZW50RW5jb3VudGVyLnBlcmlvZA0KICAgICAgICAgICAgYW5kIGV4aXN0cyAoICJCZW56b2RpYXplcGluZSBBdCBEaXNjaGFyZ2UiIEJlbnpvZGlhemVwaW5lRGlzY2hhcmdlTWVkaWNhdGlvbg0KICAgICAgICAgICAgICAgIHdoZXJlIEJlbnpvZGlhemVwaW5lRGlzY2hhcmdlTWVkaWNhdGlvbi5hdXRob3JlZE9uIGR1cmluZyBkYXkgb2YgSW5wYXRpZW50RW5jb3VudGVyLnBlcmlvZA0KICAgICAgICAgICAgKQ0KICAgICAgKQ0KDQpkZWZpbmUgIklucGF0aWVudCBFbmNvdW50ZXIgV2l0aCBFbmNvdW50ZXIgRGlhZ25vc2lzIE9mIENhbmNlciBQYWluIjoNCiAgIkRlbm9taW5hdG9yIiBRdWFsaWZ5aW5nRW5jb3VudGVyDQogICAgd2hlcmUgUXVhbGlmeWluZ0VuY291bnRlci5yZWFzb25Db2RlIGluICJDYW5jZXIgUmVsYXRlZCBQYWluIg0KICAgICAgb3IgUXVhbGlmeWluZ0VuY291bnRlci5lbmNvdW50ZXJEaWFnbm9zaXMgKCApLmNvZGUgaW4gIkNhbmNlciBSZWxhdGVkIFBhaW4iDQoNCmRlZmluZSAiRGVub21pbmF0b3IgRXhjbHVzaW9uIjoNCiAgLypFeGNsdWRlcyBlbmNvdW50ZXJzIG9mIHBhdGllbnRzIHdpdGggY2FuY2VyIHBhaW4gb3Igd2hvIGFyZSByZWNlaXZpbmcgcGFsbGlhdGl2ZSBvciBob3NwaWNlIGNhcmUgYXQgdGhlIHRpbWUgb2YgdGhlIGVuY291bnRlciBvciB3aG8gcmVjZWl2ZSB0cmVhdG1lbnQgZm9yIG9waW9pZCB1c2UgZGlzb3JkZXIsIGhhdmUgc2lja2xlIGNlbGwgZGlzZWFzZSwgb3Igd2hvIGFyZSBkaXNjaGFyZ2VkIHRvIGFub3RoZXIgaW5wYXRpZW50IGNhcmUgZmFjaWxpdHkgb3IgZGlzY2hhcmdlZCBhZ2FpbnN0IG1lZGljYWwgYWR2aWNlLCBvciBleHBpcmUgZHVyaW5nIHRoZSBpbnBhdGllbnQgc3RheSovDQogIA0KICAiRGVub21pbmF0b3IiIElucGF0aWVudEVuY291bnRlcg0KICAgIHdoZXJlIGV4aXN0cyAoIFsiQ29uZGl0aW9uUHJvYmxlbXNIZWFsdGhDb25jZXJucyI6ICJDYW5jZXIgUmVsYXRlZCBQYWluIl0gQ2FuY2VyUGFpbg0KICAgICAgICB3aGVyZSBDYW5jZXJQYWluLnByZXZhbGVuY2VJbnRlcnZhbCAoICkgb3ZlcmxhcHMgZGF5IG9mIElucGF0aWVudEVuY291bnRlci5wZXJpb2QNCiAgICAgICAgICBhbmQgKCBDYW5jZXJQYWluLnZlcmlmaWNhdGlvblN0YXR1cyBpcyBub3QgbnVsbCBpbXBsaWVzICggQ2FuY2VyUGFpbi52ZXJpZmljYXRpb25TdGF0dXMgIX4gUUlDb3JlQ29tbW9uLiJyZWZ1dGVkIg0KICAgICAgICAgICAgICAgIG9yIENhbmNlclBhaW4udmVyaWZpY2F0aW9uU3RhdHVzICF+IFFJQ29yZUNvbW1vbi4iZW50ZXJlZC1pbi1lcnJvciINCiAgICAgICAgICAgICkNCiAgICAgICAgICApDQogICAgKQ0KICAgICAgb3IgZXhpc3RzICggIklucGF0aWVudCBFbmNvdW50ZXIgV2l0aCBFbmNvdW50ZXIgRGlhZ25vc2lzIE9mIENhbmNlciBQYWluIiApDQogICAgICBvciBleGlzdHMgKCBbIkNvbmRpdGlvblByb2JsZW1zSGVhbHRoQ29uY2VybnMiOiAiU2lja2xlIENlbGwgRGlzZWFzZSB3aXRoIGFuZCB3aXRob3V0IENyaXNpcyJdIFNpY2tsZUNlbGxEaXNlYXNlDQogICAgICAgICAgd2hlcmUgU2lja2xlQ2VsbERpc2Vhc2UucHJldmFsZW5jZUludGVydmFsICggKSBvdmVybGFwcyBkYXkgb2YgSW5wYXRpZW50RW5jb3VudGVyLnBlcmlvZA0KICAgICAgICAgICAgYW5kICggU2lja2xlQ2VsbERpc2Vhc2UudmVyaWZpY2F0aW9uU3RhdHVzIGlzIG5vdCBudWxsIGltcGxpZXMgKCBTaWNrbGVDZWxsRGlzZWFzZS52ZXJpZmljYXRpb25TdGF0dXMgIX4gUUlDb3JlQ29tbW9uLiJyZWZ1dGVkIg0KICAgICAgICAgICAgICAgICAgb3IgU2lja2xlQ2VsbERpc2Vhc2UudmVyaWZpY2F0aW9uU3RhdHVzICF+IFFJQ29yZUNvbW1vbi4iZW50ZXJlZC1pbi1lcnJvciINCiAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgKQ0KICAgICAgKQ0KICAgICAgb3IgZXhpc3RzICggIlRyZWF0bWVudCBGb3IgT3Bpb2lkIFVzZSBEaXNvcmRlcnMiIE9VRFRyZWF0bWVudA0KICAgICAgICAgIHdoZXJlIE9VRFRyZWF0bWVudC5hdXRob3JlZE9uIGR1cmluZyBkYXkgb2YgSW5wYXRpZW50RW5jb3VudGVyLnBlcmlvZA0KICAgICAgKQ0KICAgICAgb3IgZXhpc3RzICggIkludGVydmVudGlvbiBQYWxsaWF0aXZlIE9yIEhvc3BpY2UgQ2FyZSIgUGFsbGlhdGl2ZU9ySG9zcGljZUNhcmUNCiAgICAgICAgICB3aGVyZSBDb2FsZXNjZShzdGFydCBvZiBQYWxsaWF0aXZlT3JIb3NwaWNlQ2FyZS5wZXJmb3JtZWQudG9JbnRlcnZhbCgpLCBQYWxsaWF0aXZlT3JIb3NwaWNlQ2FyZS5hdXRob3JlZE9uKSBkdXJpbmcgSW5wYXRpZW50RW5jb3VudGVyLmhvc3BpdGFsaXphdGlvbldpdGhPYnNlcnZhdGlvbiAoICkNCiAgICAgICkNCiAgICAgIG9yICggSW5wYXRpZW50RW5jb3VudGVyLmhvc3BpdGFsaXphdGlvbi5kaXNjaGFyZ2VEaXNwb3NpdGlvbiBpbiAiRGlzY2hhcmdlIFRvIEFjdXRlIENhcmUgRmFjaWxpdHkiDQogICAgICAgICAgb3IgSW5wYXRpZW50RW5jb3VudGVyLmhvc3BpdGFsaXphdGlvbi5kaXNjaGFyZ2VEaXNwb3NpdGlvbiBpbiAiSG9zcGljZSBDYXJlIFJlZmVycmFsIG9yIEFkbWlzc2lvbiINCiAgICAgICAgICBvciBJbnBhdGllbnRFbmNvdW50ZXIuaG9zcGl0YWxpemF0aW9uLmRpc2NoYXJnZURpc3Bvc2l0aW9uIGluICJQYXRpZW50IEV4cGlyZWQiDQogICAgICAgICAgb3IgSW5wYXRpZW50RW5jb3VudGVyLmhvc3BpdGFsaXphdGlvbi5kaXNjaGFyZ2VEaXNwb3NpdGlvbiBpbiAiTGVmdCBBZ2FpbnN0IE1lZGljYWwgQWR2aWNlIg0KICAgICAgKQ0KDQpkZWZpbmUgIlRyZWF0bWVudCBGb3IgT3Bpb2lkIFVzZSBEaXNvcmRlcnMiOg0KICAoICJNZWRpY2F0aW9ucyBGb3IgT3Bpb2lkIFVzZSBEaXNvcmRlciIgTWVkaWNhdGlvblRyZWF0bWVudA0KICAgICAgd2l0aCBbIlByb2NlZHVyZSI6ICJPcGlvaWQgTWVkaWNhdGlvbiBBc3Npc3RlZCBUcmVhdG1lbnQgKE1BVCkiXSBNQVQNCiAgICAgICAgc3VjaCB0aGF0IE1lZGljYXRpb25UcmVhdG1lbnQuYXV0aG9yZWRPbiBkdXJpbmcgZGF5IG9mIE1BVC5wZXJmb3JtZWQudG9JbnRlcnZhbCAoICkNCiAgICAgICAgICBhbmQgTWVkaWNhdGlvblRyZWF0bWVudC5hdXRob3JlZE9uIGR1cmluZyBkYXkgb2YgIk1lYXN1cmVtZW50IFBlcmlvZCINCiAgICAgICAgICBhbmQgTUFULnN0YXR1cyBpbiB7ICdjb21wbGV0ZWQnLCAnaW4tcHJvZ3Jlc3MnIH0NCiAgKQ0KICAgIHVuaW9uICggIk1lZGljYXRpb25zIEZvciBPcGlvaWQgVXNlIERpc29yZGVyIiBNZWRpY2F0aW9uVHJlYXRtZW50DQogICAgICAgIHdpdGggWyJDb25kaXRpb25Qcm9ibGVtc0hlYWx0aENvbmNlcm5zIjogIk9waW9pZCBVc2UgRGlzb3JkZXIiXSBPVUQNCiAgICAgICAgICBzdWNoIHRoYXQgTWVkaWNhdGlvblRyZWF0bWVudC5hdXRob3JlZE9uIGR1cmluZyBkYXkgb2YgT1VELnByZXZhbGVuY2VJbnRlcnZhbCAoICkNCiAgICAgICAgICAgIGFuZCBPVUQucHJldmFsZW5jZUludGVydmFsICggKSBvdmVybGFwcyBkYXkgb2YgIk1lYXN1cmVtZW50IFBlcmlvZCINCiAgICAgICAgICAgIGFuZCAoIE9VRC52ZXJpZmljYXRpb25TdGF0dXMgaXMgbm90IG51bGwgaW1wbGllcyAoIE9VRC52ZXJpZmljYXRpb25TdGF0dXMgIX4gUUlDb3JlQ29tbW9uLiJyZWZ1dGVkIg0KICAgICAgICAgICAgICAgICAgb3IgT1VELnZlcmlmaWNhdGlvblN0YXR1cyAhfiBRSUNvcmVDb21tb24uImVudGVyZWQtaW4tZXJyb3IiDQogICAgICAgICAgICAgICkNCiAgICAgICAgICAgICkNCiAgICApDQoNCmRlZmluZSAiTWVkaWNhdGlvbnMgRm9yIE9waW9pZCBVc2UgRGlzb3JkZXIiOg0KICBbIk1lZGljYXRpb25SZXF1ZXN0IjogIk1lZGljYXRpb25zIGZvciBPcGlvaWQgVXNlIERpc29yZGVyIChNT1VEKSJdIERpc2NoYXJnZU1lZGljYXRpb24NCiAgICB3aGVyZSAoIERpc2NoYXJnZU1lZGljYXRpb24uaXNDb21tdW5pdHkgKCApDQogICAgICAgIG9yIERpc2NoYXJnZU1lZGljYXRpb24uaXNEaXNjaGFyZ2UgKCApDQogICAgKQ0KICAgICAgYW5kIERpc2NoYXJnZU1lZGljYXRpb24uc3RhdHVzIGluIHsgJ2FjdGl2ZScsICdjb21wbGV0ZWQnIH0NCiAgICAgIGFuZCBEaXNjaGFyZ2VNZWRpY2F0aW9uLmludGVudCBpbiB7ICdvcmRlcicsICdvcmlnaW5hbC1vcmRlcicsICdyZWZsZXgtb3JkZXInLCAnZmlsbGVyLW9yZGVyJywgJ2luc3RhbmNlLW9yZGVyJyB9DQoNCmRlZmluZSAiSW50ZXJ2ZW50aW9uIFBhbGxpYXRpdmUgT3IgSG9zcGljZSBDYXJlIjoNCiAgKCBbIlNlcnZpY2VSZXF1ZXN0IjogIlBhbGxpYXRpdmUgb3IgSG9zcGljZSBDYXJlIl0gUGFsbGlhdGl2ZU9ySG9zcGljZUNhcmVPcmRlcg0KICAgICAgd2hlcmUgUGFsbGlhdGl2ZU9ySG9zcGljZUNhcmVPcmRlci5zdGF0dXMgaW4geyAnYWN0aXZlJywgJ2NvbXBsZXRlZCcsICdvbi1ob2xkJyB9DQogICkNCiAgICB1bmlvbiAoIFsiUHJvY2VkdXJlIjogIlBhbGxpYXRpdmUgb3IgSG9zcGljZSBDYXJlIl0gUGFsbGlhdGl2ZU9ySG9zcGljZUNhcmVQZXJmb3JtZWQNCiAgICAgICAgd2hlcmUgUGFsbGlhdGl2ZU9ySG9zcGljZUNhcmVQZXJmb3JtZWQuc3RhdHVzIGluIHsgJ2NvbXBsZXRlZCcsICdpbi1wcm9ncmVzcycgfQ0KICAgICkNCg0KZGVmaW5lICJTREUgRXRobmljaXR5IjoNCiAgU0RFLiJTREUgRXRobmljaXR5Ig0KDQpkZWZpbmUgIlNERSBQYXllciI6DQogIFNERS4iU0RFIFBheWVyIg0KDQpkZWZpbmUgIlNERSBSYWNlIjoNCiAgU0RFLiJTREUgUmFjZSINCg0KZGVmaW5lICJTREUgU2V4IjoNCiAgU0RFLiJTREUgU2V4Ig=="
  } ]
}